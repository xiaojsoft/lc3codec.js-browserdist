<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">

        <title>LC3 Encoder Test</title>

        <script type="text/javascript" src="./../../lc3.es5.min.js"></script>
        <script>
            //
            //  Aliases.
            //
            var LC3FrameDuration = LC3.Core.LC3FrameDuration;
            var LC3SampleRate = LC3.Core.LC3SampleRate;
            var LC3Encoder = LC3.Encoder.LC3Encoder;

            //
            //  Event Handlers.
            //
            function RunTest_10000US() {
                var frames = [
                    [0,3212,6392,9512,12539,15446,18205,20788,23170,25328,27244,28898,30272,31357,32137,32609,32767,32609,32138,31356,30272,28898,27245,25330,23169,20787,18205,15446,12539,9511,6393,3212,0,-3212,-6393,-9512,-12540,-15446,-18204,-20787,-23170,-25329,-27245,-28898,-30273,-31356,-32137,-32610,-32766,-32609,-32137,-31356,-30272,-28898,-27244,-25329,-23171,-20787,-18204,-15446,-12539,-9511,-6393,-3212,-1,3212,6393,9512,12540,15446,18204,20788,23169,25329,27245,28898,30273,31356,32137,32609,32767,32609,32137,31356,30273,28898,27245,25330,23170,20787,18204,15446,12540,9512,6393,3212,0,-3212,-6393,-9512,-12539,-15447,-18204,-20787,-23170,-25330,-27244,-28898,-30272,-31356,-32137,-32609,-32767,-32609,-32137,-31356,-30273,-28898,-27244,-25330,-23169,-20787,-18204,-15446,-12540,-9511,-6393,-3212,0,3212,6392,9511,12539,15446,18205,20787,23169,25329,27245,28898,30273,31356,32137,32609,32767,32610,32137,31356,30273,28898,27244,25329,23170,20787,18204,15446,12540,9511,6392,3211],
                    [0,-3211,-6393,-9512,-12539,-15446,-18204,-20788,-23170,-25329,-27245,-28898,-30273,-31356,-32137,-32609,-32767,-32609,-32138,-31356,-30273,-28898,-27245,-25329,-23170,-20788,-18205,-15447,-12539,-9512,-6392,-3211,0,3211,6393,9512,12539,15446,18204,20787,23170,25329,27244,28897,30273,31356,32137,32609,32767,32609,32137,31356,30273,28897,27244,25330,23170,20787,18205,15446,12539,9512,6393,3213,0,-3212,-6393,-9512,-12540,-15447,-18205,-20787,-23169,-25329,-27245,-28897,-30273,-31356,-32138,-32609,-32767,-32609,-32138,-31356,-30273,-28898,-27244,-25330,-23170,-20787,-18205,-15446,-12540,-9513,-6392,-3212,0,3212,6393,9512,12540,15446,18204,20788,23170,25329,27245,28898,30272,31356,32138,32609,32767,32609,32138,31356,30273,28898,27244,25330,23170,20787,18204,15446,12540,9512,6392,3211,0,-3211,-6393,-9512,-12539,-15446,-18205,-20786,-23170,-25329,-27245,-28898,-30272,-31356,-32137,-32609,-32766,-32609,-32137,-31356,-30273,-28898,-27245,-25329,-23170,-20787,-18204,-15446,-12539,-9511,-6393,-3212]
                ];

                //  Set encoder configurations.
                var Nms = LC3FrameDuration.NMS_10000US;
                var Fs = LC3SampleRate.FS_16000;
                var nbytes = 40;

                //  Create encoder.
                var ec = new LC3Encoder(Nms, Fs);

                //  Create buffer.
                var bytebuf = null;
                if (typeof(Uint8Array) != "undefined") {
                    bytebuf = new Uint8Array(nbytes);
                } else {
                    bytebuf = new Array(nbytes);
                }

                //  Encode frames.
                for (let i = 0; i < frames.length; ++i) {
                    ec.encode(frames[i], nbytes, bytebuf);
                    console.log(bytebuf);
                }
            }

            function RunTest_07500US() {
                var frames = [
                    [0,3212,6392,9512,12539,15446,18205,20788,23170,25328,27244,28898,30272,31357,32137,32609,32767,32609,32138,31356,30272,28898,27245,25330,23169,20787,18205,15446,12539,9511,6393,3212,0,-3212,-6393,-9512,-12540,-15446,-18204,-20787,-23170,-25329,-27245,-28898,-30273,-31356,-32137,-32610,-32766,-32609,-32137,-31356,-30272,-28898,-27244,-25329,-23171,-20787,-18204,-15446,-12539,-9511,-6393,-3212,-1,3212,6393,9512,12540,15446,18204,20788,23169,25329,27245,28898,30273,31356,32137,32609,32767,32609,32137,31356,30273,28898,27245,25330,23170,20787,18204,15446,12540,9512,6393,3212,0,-3212,-6393,-9512,-12539,-15447,-18204,-20787,-23170,-25330,-27244,-28898,-30272,-31356,-32137,-32609,-32767,-32609,-32137,-31356,-30273,-28898,-27244,-25330],
                    [-23169,-20787,-18204,-15446,-12540,-9511,-6393,-3212,0,3212,6392,9511,12539,15446,18205,20787,23169,25329,27245,28898,30273,31356,32137,32609,32767,32610,32137,31356,30273,28898,27244,25329,23170,20787,18204,15446,12540,9511,6392,3211,0,-3211,-6393,-9512,-12539,-15446,-18204,-20788,-23170,-25329,-27245,-28898,-30273,-31356,-32137,-32609,-32767,-32609,-32138,-31356,-30273,-28898,-27245,-25329,-23170,-20788,-18205,-15447,-12539,-9512,-6392,-3211,0,3211,6393,9512,12539,15446,18204,20787,23170,25329,27244,28897,30273,31356,32137,32609,32767,32609,32137,31356,30273,28897,27244,25330,23170,20787,18205,15446,12539,9512,6393,3213,0,-3212,-6393,-9512,-12540,-15447,-18205,-20787,-23169,-25329,-27245,-28897,-30273,-31356,-32138,-32609]
                ];

                //  Set encoder configurations.
                var Nms = LC3FrameDuration.NMS_07500US;
                var Fs = LC3SampleRate.FS_16000;
                var nbytes = 30;

                //  Create encoder.
                var ec = new LC3Encoder(Nms, Fs);

                //  Create buffer.
                var bytebuf = null;
                if (typeof(Uint8Array) != "undefined") {
                    bytebuf = new Uint8Array(nbytes);
                } else {
                    bytebuf = new Array(nbytes);
                }

                //  Encode frames.
                for (let i = 0; i < frames.length; ++i) {
                    ec.encode(frames[i], nbytes, bytebuf);
                    console.log(bytebuf);
                }
            }
        </script>
    </head>
    <body>
        <h2>LC3 Encoder Test</h2>
        <p>Please open DevTools and then click following buttons:</p>
        <button onclick="javascript: RunTest_10000US();">Run 10ms, 16ksps, 32kbps test</button>
        <button onclick="javascript: RunTest_07500US();">Run 7.5ms, 16ksps, 32kbps test</button>
        <p>(see Appendix C of the official LC3 specification for more information)</p>
    </body>
</html>